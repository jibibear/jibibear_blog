{"version":3,"file":"darkmode-CximRZRj.js","sources":["../../src/client/modules/outlook/composables/useDarkmode.ts"],"sourcesContent":["import { usePreferredDark, useStorage } from \"@vueuse/core\";\nimport type { App, ComputedRef, InjectionKey, Ref } from \"vue\";\nimport { computed, inject, onMounted, watch, watchEffect } from \"vue\";\n\nimport { useThemeData } from \"@theme-hope/composables/index\";\n\nimport type { DarkmodeOptions } from \"../../../../shared/index.js\";\n\ndeclare const __VUEPRESS_DEV__: boolean;\n\nexport type DarkmodeStatus = \"light\" | \"dark\" | \"auto\";\n\nexport type DarkModeRef = ComputedRef<boolean>;\n\nexport type DarkModeStatusRef = Ref<DarkmodeStatus>;\n\nexport interface DarkMode {\n  isDarkmode: DarkModeRef;\n  config: ComputedRef<DarkmodeOptions>;\n  status: DarkModeStatusRef;\n  canToggle: ComputedRef<boolean>;\n}\n\nexport const darkModeSymbol: InjectionKey<DarkMode> = Symbol(\n  __VUEPRESS_DEV__ ? \"darkMode\" : \"\",\n);\n\n/**\n * Inject dark mode global computed\n */\nexport const useDarkmode = (): DarkMode => {\n  const darkmode = inject(darkModeSymbol);\n\n  if (!darkmode) throw new Error(\"useDarkmode() is called without provider.\");\n\n  return darkmode;\n};\n\nexport const injectDarkmode = (app: App): void => {\n  const themeData = useThemeData();\n  const isDarkPreferred = usePreferredDark();\n  const config = computed(() => themeData.value.darkmode ?? \"switch\");\n\n  const status = useStorage<DarkmodeStatus>(\n    \"vuepress-theme-hope-scheme\",\n    \"auto\",\n  );\n\n  const isDarkmode = computed(() => {\n    const darkmode = config.value;\n\n    // Disable darkmode\n    return darkmode === \"disable\"\n      ? false\n      : // Force darkmode\n        darkmode === \"enable\"\n        ? true\n        : // Auto\n          darkmode === \"auto\"\n          ? isDarkPreferred.value\n          : // Toggle\n            darkmode === \"toggle\"\n            ? status.value === \"dark\"\n            : // Switch\n              status.value === \"dark\" ||\n              (status.value === \"auto\" && isDarkPreferred.value);\n  });\n\n  const canToggle = computed(() => {\n    const darkmode = config.value;\n\n    return darkmode === \"switch\" || darkmode === \"toggle\";\n  });\n\n  app.provide(darkModeSymbol, {\n    canToggle,\n    config,\n    isDarkmode,\n    status,\n  });\n\n  // Provide global helpers\n  Object.defineProperties(app.config.globalProperties, {\n    $isDarkmode: { get: () => isDarkmode.value },\n  });\n};\n\nexport const setupDarkmode = (): void => {\n  const { config, isDarkmode, status } = useDarkmode();\n\n  watchEffect(() => {\n    if (config.value === \"disable\") status.value = \"light\";\n    else if (config.value === \"enable\") status.value = \"dark\";\n    else if (config.value === \"toggle\" && status.value === \"auto\")\n      status.value = \"light\";\n  });\n\n  onMounted(() => {\n    watch(\n      isDarkmode,\n      (isDarkmode) => {\n        document.documentElement.setAttribute(\n          \"data-theme\",\n          isDarkmode ? \"dark\" : \"light\",\n        );\n      },\n      { immediate: true },\n    );\n  });\n};\n\ndeclare module \"vue\" {\n  export interface ComponentCustomProperties {\n    $isDarkmode: boolean;\n  }\n}\n"],"names":["darkModeSymbol","useDarkmode","darkmode","inject","injectDarkmode","app","themeData","useThemeData","isDarkPreferred","usePreferredDark","config","computed","status","useStorage","isDarkmode","canToggle","setupDarkmode","watchEffect","onMounted","watch"],"mappings":"qMAuBO,MAAMA,EAAyC,OACpD,iBAAmB,WAAa,EAClC,EAKaC,EAAc,IAAgB,CACzC,MAAMC,EAAWC,EAAOH,CAAc,EAEtC,GAAI,CAACE,EAAU,MAAM,IAAI,MAAM,2CAA2C,EAE1E,OAAOA,CACT,EAEaE,EAAkBC,GAAmB,CAChD,MAAMC,EAAYC,EAAa,EACzBC,EAAkBC,EAAiB,EACnCC,EAASC,EAAS,IAAML,EAAU,MAAM,UAAY,QAAQ,EAE5DM,EAASC,EACb,6BACA,MACF,EAEMC,EAAaH,EAAS,IAAM,CAChC,MAAMT,EAAWQ,EAAO,MAGxB,OAAOR,IAAa,UAChB,GAEAA,IAAa,SACX,GAEAA,IAAa,OACXM,EAAgB,MAEhBN,IAAa,SACXU,EAAO,QAAU,OAEjBA,EAAO,QAAU,QAChBA,EAAO,QAAU,QAAUJ,EAAgB,KACxD,CAAC,EAEKO,EAAYJ,EAAS,IAAM,CAC/B,MAAMT,EAAWQ,EAAO,MAExB,OAAOR,IAAa,UAAYA,IAAa,QAC/C,CAAC,EAEDG,EAAI,QAAQL,EAAgB,CAC1B,UAAAe,EACA,OAAAL,EACA,WAAAI,EACA,OAAAF,CACF,CAAC,EAGD,OAAO,iBAAiBP,EAAI,OAAO,iBAAkB,CACnD,YAAa,CAAE,IAAK,IAAMS,EAAW,KAAM,CAC7C,CAAC,CACH,EAEaE,EAAgB,IAAY,CACvC,KAAM,CAAE,OAAAN,EAAQ,WAAAI,EAAY,OAAAF,CAAO,EAAIX,EAAA,EAEvCgB,EAAY,IAAM,CACZP,EAAO,QAAU,UAAWE,EAAO,MAAQ,QACtCF,EAAO,QAAU,SAAUE,EAAO,MAAQ,OAC1CF,EAAO,QAAU,UAAYE,EAAO,QAAU,SACrDA,EAAO,MAAQ,QACnB,CAAC,EAEDM,EAAU,IAAM,CACdC,EACEL,EACCA,GAAe,CACd,SAAS,gBAAgB,aACvB,aACAA,EAAa,OAAS,OACxB,CACF,EACA,CAAE,UAAW,EAAK,CACpB,CACF,CAAC,CACH"}